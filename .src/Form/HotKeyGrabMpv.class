' Gambas class file

Public hotkey_out As String


Public Sub Run() As Boolean

  Return Not Me.ShowModal()

End

Public Sub btnOK_Click()

  Me.Close(True)

End

Public Sub btnCancel_Click()

  Me.Close

End

Public Sub Form_Show()
  ComboBox1.add("SPACE")
  ComboBox1.add("SHARP")
  ComboBox1.add("IDEOGRAPHIC_SPACE")
  ComboBox1.add("ENTER")
  ComboBox1.add("TAB")
  ComboBox1.add("BS")
  ComboBox1.add("DEL")
  ComboBox1.add("INS")
  ComboBox1.add("HOME")
  ComboBox1.add("END")
  ComboBox1.add("PGUP")
  ComboBox1.add("PGDWN")
  ComboBox1.add("ESC")
  ComboBox1.add("PRINT")
  ComboBox1.add("RIGHT")
  ComboBox1.add("LEFT")
  ComboBox1.add("DOWN")
  ComboBox1.add("UP")
  ComboBox1.add("F1")
  ComboBox1.add("F2")
  ComboBox1.add("F3")
  ComboBox1.add("F4")
  ComboBox1.add("F5")
  ComboBox1.add("F6")
  ComboBox1.add("F7")
  ComboBox1.add("F8")
  ComboBox1.add("F9")
  ComboBox1.add("F10")
  ComboBox1.add("F11")
  ComboBox1.add("F12")
  ComboBox1.add("KP0")
  ComboBox1.add("KP1")
  ComboBox1.add("KP2")
  ComboBox1.add("KP3")
  ComboBox1.add("KP4")
  ComboBox1.add("KP5")
  ComboBox1.add("KP6")
  ComboBox1.add("KP7")
  ComboBox1.add("KP8")
  ComboBox1.add("KP9")
  ComboBox1.add("KP_DEL")
  ComboBox1.add("KP_DEC")
  ComboBox1.add("KP_INS")
  ComboBox1.add("KP_ENTER")
  ComboBox1.add("MBTN_LEFT")
  ComboBox1.add("MBTN_MID")
  ComboBox1.add("MBTN_RIGHT")
  ComboBox1.add("WHEEL_UP")
  ComboBox1.add("WHEEL_DOWN")
  ComboBox1.add("WHEEL_LEFT")
  ComboBox1.add("WHEEL_RIGHT")
  ComboBox1.add("MBTN_BACK")
  ComboBox1.add("MBTN_FORWARD")
  ComboBox1.add("MBTN9")
  ComboBox1.add("MBTN10")
  ComboBox1.add("MBTN11")
  ComboBox1.add("MBTN12")
  ComboBox1.add("MBTN13")
  ComboBox1.add("MBTN14")
  ComboBox1.add("MBTN15")
  ComboBox1.add("MBTN16")
  ComboBox1.add("MBTN17")
  ComboBox1.add("MBTN18")
  ComboBox1.add("MBTN19")
  ComboBox1.add("MBTN_LEFT_DBL")
  ComboBox1.add("MBTN_MID_DBL")
  ComboBox1.add("MBTN_RIGHT_DBL")
  ComboBox1.add("AR_PLAY")
  ComboBox1.add("AR_PLAY_HOLD")
  ComboBox1.add("AR_CENTER")
  ComboBox1.add("AR_CENTER_HOLD")
  ComboBox1.add("AR_NEXT")
  ComboBox1.add("AR_NEXT_HOLD")
  ComboBox1.add("AR_PREV")
  ComboBox1.add("AR_PREV_HOLD")
  ComboBox1.add("AR_MENU")
  ComboBox1.add("AR_MENU_HOLD")
  ComboBox1.add("AR_VUP")
  ComboBox1.add("AR_VUP_HOLD")
  ComboBox1.add("AR_VDOWN")
  ComboBox1.add("AR_VDOWN_HOLD")
  ComboBox1.add("POWER")
  ComboBox1.add("MENU")
  ComboBox1.add("PLAY")
  ComboBox1.add("PAUSE")
  ComboBox1.add("PLAYPAUSE")
  ComboBox1.add("STOP")
  ComboBox1.add("FORWARD")
  ComboBox1.add("REWIND")
  ComboBox1.add("NEXT")
  ComboBox1.add("PREV")
  ComboBox1.add("VOLUME_UP")
  ComboBox1.add("VOLUME_DOWN")
  ComboBox1.add("MUTE")
  ComboBox1.add("HOMEPAGE")
  ComboBox1.add("WWW")
  ComboBox1.add("MAIL")
  ComboBox1.add("FAVORITES")
  ComboBox1.add("SEARCH")
  ComboBox1.add("SLEEP")
  ComboBox1.add("CANCEL")
  ComboBox1.add("RECORD")
  ComboBox1.add("CHANNEL_UP")
  ComboBox1.add("CHANNEL_DOWN")
  ComboBox1.add("XF86_PAUSE")
  ComboBox1.add("XF86_STOP")
  ComboBox1.add("XF86_PREV")
  ComboBox1.add("XF86_NEXT")
  ComboBox1.add("MOUSE_BTN0")
  ComboBox1.add("MOUSE_BTN1")
  ComboBox1.add("MOUSE_BTN2")
  ComboBox1.add("MOUSE_BTN3")
  ComboBox1.add("MOUSE_BTN4")
  ComboBox1.add("MOUSE_BTN5")
  ComboBox1.add("MOUSE_BTN6")
  ComboBox1.add("MOUSE_BTN7")
  ComboBox1.add("MOUSE_BTN8")
  ComboBox1.add("MOUSE_BTN9")
  ComboBox1.add("MOUSE_BTN10")
  ComboBox1.add("MOUSE_BTN11")
  ComboBox1.add("MOUSE_BTN12")
  ComboBox1.add("MOUSE_BTN13")
  ComboBox1.add("MOUSE_BTN14")
  ComboBox1.add("MOUSE_BTN15")
  ComboBox1.add("MOUSE_BTN16")
  ComboBox1.add("MOUSE_BTN17")
  ComboBox1.add("MOUSE_BTN18")
  ComboBox1.add("MOUSE_BTN19")
  ComboBox1.add("MOUSE_BTN0_DBL")
  ComboBox1.add("MOUSE_BTN1_DBL")
  ComboBox1.add("MOUSE_BTN2_DBL")
  ComboBox1.add("AXIS_UP")
  ComboBox1.add("AXIS_DOWN")
  ComboBox1.add("AXIS_LEFT")
  ComboBox1.add("AXIS_RIGHT")
  ComboBox1.add("CLOSE_WIN")
  ComboBox1.add("MOUSE_MOVE")
  ComboBox1.add("MOUSE_LEAVE")
  ComboBox1.add("MOUSE_ENTER")
  ComboBox1.add("UNMAPPED")
  ComboBox1.add(",")
  ComboBox1.add(".")
  ComboBox1.add("-")
  ComboBox1.add("ù")
  ComboBox1.add("à")
  ComboBox1.add("ò")
  ComboBox1.add("è")
  ComboBox1.add("+")
  ComboBox1.add("ì")
  ComboBox1.add("'")
  ComboBox1.add("\\")
  ComboBox1.add("|")
  ComboBox1.add("!")
  ComboBox1.add("\"")
  ComboBox1.add("£")
  ComboBox1.add("$")
  ComboBox1.add("%")
  ComboBox1.add("&")
  ComboBox1.add("/")
  ComboBox1.add("(")
  ComboBox1.add(")")
  ComboBox1.add("=")
  ComboBox1.add("?")
  ComboBox1.add("^")
  ComboBox1.add("é")
  ComboBox1.add("§")
  ComboBox1.add("°")
  ComboBox1.add("ç")
  ComboBox1.add("_")
  ComboBox1.add(":")
  ComboBox1.add(";")
  ComboBox1.add("]")
  ComboBox1.add("[")
  ComboBox1.add("@")
  ComboBox1.add("`")
  ComboBox1.add("{")
  ComboBox1.add("}")
  ComboBox1.add("*")
  ComboBox1.add("a")
  ComboBox1.add("b")
  ComboBox1.add("c")
  ComboBox1.add("d")
  ComboBox1.add("e")
  ComboBox1.add("f")
  ComboBox1.add("g")
  ComboBox1.add("h")
  ComboBox1.add("i")
  ComboBox1.add("j")
  ComboBox1.add("k")
  ComboBox1.add("l")
  ComboBox1.add("m")
  ComboBox1.add("n")
  ComboBox1.add("o")
  ComboBox1.add("p")
  ComboBox1.add("q")
  ComboBox1.add("r")
  ComboBox1.add("t")
  ComboBox1.add("s")
  ComboBox1.add("u")
  ComboBox1.add("v")
  ComboBox1.add("w")
  ComboBox1.add("x")
  ComboBox1.add("y")
  ComboBox1.add("z")
End

Public Sub generate_mpv_hotkey()
  Dim hk As String = ""
  If togglebutton1.value Then hk &= togglebutton1.tag & "+"
  If togglebutton2.value Then hk &= togglebutton2.tag & "+"
  If togglebutton3.value Then hk &= togglebutton3.tag & "+"
  If togglebutton4.value Then hk &= togglebutton4.tag & "+"
  hk &= ComboBox1.text
  textbox1.text = hk
  hotkey_out = hk
End

Public Sub change_mpv_hotkey_group_Click()
  generate_mpv_hotkey()
End

Public Sub change_mpv_hotkey_group_Change()
  generate_mpv_hotkey()
End

Public Sub TextBox1_Change()
  hotkey_out = textbox1.text
End
